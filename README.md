Техническое задание
====
Интерактивный сайт «Вопросы и Ответы». Этот сервис позволит пользователям Интернета задавать вопросы и получать на них ответы. Возможности комментирования и голосования формируют сообщество и позволяет пользователям активно помогать другим. 


Используемые технологии
-----
Код приложения пишется на python/django, приложение запускается на apache в связке в mod_wsgi. База данных – mysql. Для отдачи статики используется nginx. Для полнотекстового поиска — используется sphinx. Верстка выполняется с использованием twitter bootstrap. Взаимодействие интерфейса с пользователем обеспечивается javascript/jquery. Планировка задач по cron.

Основные сущности
--
- Пользователь – электронная почта, никнейм, пароль, аватарка, дата регистрации, рейтинг.
- Вопрос – заголовок, содержание, автор, дата создания, тэги.
- Ответ – содержание, автор, дата написания, флаг правильного ответа.
- Тэг — слово тэга.


Основные страницы и формы
---
-  **Листинг вопросов** с пагинацией по 20 штук на странице с сортировкой по дате добавления и рейтингу. В шапке сайта находятся: логотип, поисковая строка (для быстрого поиска), кнопка задать вопрос (доступна только авторизованным). В правой части шапки — юзерблок. Для авторизованного пользователя юзерблок содержит его ник, аватарку, ссылки на “выход” и на страницу с его профилем. Для неавторизованных — ссылки “войти” и “регистрация”. В правой колонке — информационные блоки “Популярные тэги” и “Лучшие пользователи” (описание ниже).
![Alt text](https://raw.githubusercontent.com/streambuf/interactive_site_qa/master/screenshots/1.png "")


-  **Страница добавления вопроса**. Доступна только для авторизованных пользователей. В форма вводится заголовок, текст вопроса и тэги, через запятую. С вопросом может быть связано не более 3 тегов. Если вопрос успешно добавлен — пользователя перебрасывает на страницу вопроса, если возникли ошибки — их нужно отобразить в форме.
![Alt text](https://raw.githubusercontent.com/streambuf/interactive_site_qa/master/screenshots/2.png "")

-  **Страница вопроса со списком ответов**. На странице вопроса можно добавить ответ. Ответы сортируются по рейтингу и дате добавления при равном рейтинге. Ответы разбиваются по 30 штук на странице. Форма добавления ответа находится на странице вопроса. Отображается только для авторизованных пользователей. После добавления ответа, автор вопроса получает email с уведомление от новом ответе. Автор вопроса может пометить один из ответов как правильный. Пользователи могут голосовать за вопросы и ответы с помощью лайков «+» или «–». Один пользователь может голосовать за 1 вопрос и ответ только 1 раз, однаком может отменить свой выбор или переголосовать неограниченное число раз.

![Alt text](https://raw.githubusercontent.com/streambuf/interactive_site_qa/master/screenshots/3.png "")

-  **Страница результатов полнотекстового поиска.** Состоит из поисковой строки и листинга вопросов. Сортировка — по релевантности. Пагинация по 20 вопросов. Поиск идет одновременно по текстам вопросов и ответов, но в списке только вопросы. Т.е. если совпадение найдено в тексте ответа — выводить нужно соответвующий вопрос. Найденная часть текста подсвечена другим цветом. Для полнотекстового поиска используется sphinx. Индексация запускается периодически из cron.

![Alt text](https://raw.githubusercontent.com/streambuf/interactive_site_qa/master/screenshots/4.png "")

-  **Листинг вопросов по тэгу.** На этой странице выводятся все вопросы содержащие некоторый тэг. Сортировка по рейтингу вопроса. Пагинация по 20 вопросов. Пользователи попадают на эту страницу кликая по одному из тэгов в описании вопроса.



-  **Страница пользователя** содержит его настройки — email, nick и аватарку. Каждый пользователь может смотреть только свою страницу. У пользователя есть возможность изменить email, nick и аватарку.



-  **Форма авторизации**. Состоит из поля логин и пароль. Дополнительно есть ссылка на форму регистрации. При успешной авторизации пользователь перебрасывается на исходную страницу, при неуспешной авторизации — ему показывается ошибка. Для авторизованных пользователей вместо этой формы показывается кнопка “Выйти”.



-  **Страница регистрации.** Любой пользователь может зарегистрироваться на сайте, заполнив форму с электронной почтой, никнеймом, аватаркой и паролем. Аватарка загружается на сервер и отображается рядом с вопросами и ответами пользователя.


-  **Блок популярных тэгов**
В правой колонке сайте находится облако из 20 наиболее популярных тегов, т.е. те тэги, которые были использованы в наибольшем количесве вопросов. Генерация этого блока занимает много времени, поэтому этот блок генерируется в фоне, с помощью cron скрипта.

-  **Блок лучших пользователи (недели)**
В блок лучшие пользователи попадают 10 авторов задавших самые популярные вопросы или ответы за последнюю неделю.  Генерация этого блока занимает много времени, поэтому блок нужно подготавливается в фоне, с помощью cron скрипта.

Выполнено:
--------
- Настройка nginx для отдачи статического контента
 - кэширование 
 - проксирование 


- Настройка apache для запуска django через wsgi

- Настройка django в качестве бэкенда

- Проектирование моделей

- Оптимизация базы данных

- Наполнение базы тестовыми данными
  - Пользователи > 10 000
  - Вопросы > 100 000
  - Ответы > 1 000 000
  - Теги > 10 000 
 - использовани django model, command 
    картинки, вменяемые тексты 


- Отображение списка вопросов
 - пагинация
 - правильные URL для всех гиперссылок
 - корректная обработка “неправильных” параметров 


- Отображение страницы вопроса 
 - пагинация ответов —
 - учет авторизации и авторства (свой / чужой вопрос) 


- Форма входа и выхода с сайта 
 - Страница регистрации
 - отображение ошибок при регистрации


- Загрузка и отображение аватарок пользователей 
 - заливка картинок в uplods 
  -  отображение картинок из uploads


- Страница редактирования профиля
 - отображение ошибок 
 -   отображение и загрузка автарки 


- Добавление вопроса
 - проверка авторизации, csrf, метода запроса 
 -   добавление тэгов
  -  отображение ошибок 
  - правильные редиректы


- Добавление ответа 
 - проверка авторизации, csrf, метода запроса 
 -   редирект на добавленный ответ


- Отметка “правильный ответ”
 - проверка авторизации, csrf, метода запроса, авторства, ajax


- Лайки вопросов
 - проверка авторизации, csrf, метода запроса, авторства 
 - ajax 
 

- Полнотекстовый поиск 
 - настройка  django — sphinx 
 -   настройка индексатора sphinx 
 -   страница полнотекстового поиска 
 -   одновременный поиск по вопросам и ответам 


- Блок популярные тэги 
 - правильный рассчет тэгов 
 - предварительный рассчет по cron 


- Блок лучшие пользователи 
 - правильный рассчет пользователей 
 - предварительный рассчет по cron 


- Отправка почтовых уведомлений 

